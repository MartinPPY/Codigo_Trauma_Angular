<div class="btn-back">
  <a matIconButton routerLink="/auth/login"> <mat-icon> arrow_back </mat-icon> </a>
</div>


<main>
  <mat-card appearance="outlined">
    <mat-card-content>
      <mat-stepper linear="true" #stepper [orientation]="isMobileOrTablet() ? 'vertical' : 'horizontal' " >
        <mat-step [stepControl]="emailVerification">

          <form [formGroup]="emailVerification" (ngSubmit)="verificateEmail(stepper)">

            <ng-template matStepLabel>Verifica tu correo electronico</ng-template>

            <mat-form-field appearance="outline">
              <mat-label>Correo electronico:</mat-label>
              <mat-error>Correo electrónico invalido</mat-error>
              <input matInput formControlName="email">
            </mat-form-field>

            <div>
              @if (isLoading) {
              <mat-spinner></mat-spinner>
              }@else {
              <button matButton type="submit">
                Verificar</button>
              }
            </div>

          </form>

        </mat-step>

        <mat-step [stepControl]="registerForm" label="Ingresa tus datos personales">

          <form [formGroup]="registerForm" (ngSubmit)="register(stepper)">
            <mat-form-field appearance="outline">
              <mat-label>Nombre de usuario:</mat-label>
              <input matInput formControlName="username" required>
              <mat-error>Nombre de usuario invalido!</mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Nombres:</mat-label>
              <input matInput formControlName="name" required>
              <mat-error>Nombre invalido</mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Apellidos:</mat-label>
              <input matInput formControlName="lastname" required>
              <mat-error>Apellido invalido</mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Numero de telefono:</mat-label>
              <input matInput formControlName="phone" type="number" required>
              <mat-error>Numero de telefono invalido!</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Contraseña:</mat-label>
              <input matInput [type]="hide() ? 'password' : 'text'" formControlName="password" />
              <button matIconButton matSuffix (click)="clickEvent($event)" [attr.aria-label]="'Hide password'"
                [attr.aria-pressed]="hide()" type="button">
                <mat-icon>{{hide() ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
              <mat-hint> Debe contener Mayusculas, Minusculas, Numeros y caracteres raros </mat-hint>
              <mat-error> Contraseña invalida </mat-error>
            </mat-form-field>

            <div class="register-options">
              <button matButton matStepperPrevious [disabled]="isLoading ? true : false" >Atrás</button>
              <button matButton [disabled]="isLoading  ? true : false" >{{isLoading ? 'Cargando...' : 'Registrarme'}}</button>
            </div>
          </form>

        </mat-step>
        <mat-step>
          <ng-template matStepLabel>Hecho</ng-template>
          <p>Tus datos se han registrado correctamente!</p>
          <div>
            <a matButton routerLink="/auth/login"> Iniciar sesión </a>
          </div>
        </mat-step>
      </mat-stepper>
    </mat-card-content>
  </mat-card>

</main>